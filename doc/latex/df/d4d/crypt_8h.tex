\hypertarget{crypt_8h}{\section{Extra\+Sensory/minizip/crypt.h File Reference}
\label{crypt_8h}\index{Extra\+Sensory/minizip/crypt.\+h@{Extra\+Sensory/minizip/crypt.\+h}}
}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{crypt_8h_a9f548005c00fa0754e9c23b7726bf741}{C\+R\+C32}(c, b)~(($\ast$(pcrc\+\_\+32\+\_\+tab+(((\hyperlink{ioapi_8h_a787fa3cf048117ba7123753c1e74fcd6}{int})(c) $^\wedge$ (b)) \& 0xff))) $^\wedge$ ((c) $>$$>$ 8))
\item 
\#define \hyperlink{crypt_8h_a2ac0d8ec3c867c44d730a188d8b0418e}{zdecode}(pkeys, pcrc\+\_\+32\+\_\+tab, c)~(\hyperlink{crypt_8h_a02bf289cd0d1f899311675e0b3e508d0}{update\+\_\+keys}(pkeys,pcrc\+\_\+32\+\_\+tab,c $^\wedge$= \hyperlink{crypt_8h_a8d03722799f8c0c3e0bc1647907e29ab}{decrypt\+\_\+byte}(pkeys,pcrc\+\_\+32\+\_\+tab)))
\item 
\#define \hyperlink{crypt_8h_ab9d6a91abe3a1127f8b5476ba9ee9316}{zencode}(pkeys, pcrc\+\_\+32\+\_\+tab, c, t)~(t=\hyperlink{crypt_8h_a8d03722799f8c0c3e0bc1647907e29ab}{decrypt\+\_\+byte}(pkeys,pcrc\+\_\+32\+\_\+tab), \hyperlink{crypt_8h_a02bf289cd0d1f899311675e0b3e508d0}{update\+\_\+keys}(pkeys,pcrc\+\_\+32\+\_\+tab,c), t$^\wedge$(c))
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{ioapi_8h_a787fa3cf048117ba7123753c1e74fcd6}{int} \hyperlink{crypt_8h_a8d03722799f8c0c3e0bc1647907e29ab}{decrypt\+\_\+byte} (unsigned \hyperlink{ioapi_8h_a3c7b35ad9dab18b8310343c201f7b27e}{long} $\ast$pkeys, const unsigned \hyperlink{ioapi_8h_a3c7b35ad9dab18b8310343c201f7b27e}{long} $\ast$pcrc\+\_\+32\+\_\+tab)
\item 
static \hyperlink{ioapi_8h_a787fa3cf048117ba7123753c1e74fcd6}{int} \hyperlink{crypt_8h_a02bf289cd0d1f899311675e0b3e508d0}{update\+\_\+keys} (unsigned \hyperlink{ioapi_8h_a3c7b35ad9dab18b8310343c201f7b27e}{long} $\ast$pkeys, const unsigned \hyperlink{ioapi_8h_a3c7b35ad9dab18b8310343c201f7b27e}{long} $\ast$pcrc\+\_\+32\+\_\+tab, \hyperlink{ioapi_8h_a787fa3cf048117ba7123753c1e74fcd6}{int} c)
\item 
static void \hyperlink{crypt_8h_a94fdfecb4e9befa8cebfca6a04ed67b3}{init\+\_\+keys} (const char $\ast$passwd, unsigned \hyperlink{ioapi_8h_a3c7b35ad9dab18b8310343c201f7b27e}{long} $\ast$pkeys, const unsigned \hyperlink{ioapi_8h_a3c7b35ad9dab18b8310343c201f7b27e}{long} $\ast$pcrc\+\_\+32\+\_\+tab)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{crypt_8h_a9f548005c00fa0754e9c23b7726bf741}{\index{crypt.\+h@{crypt.\+h}!C\+R\+C32@{C\+R\+C32}}
\index{C\+R\+C32@{C\+R\+C32}!crypt.\+h@{crypt.\+h}}
\subsubsection[{C\+R\+C32}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\+R\+C32(
\begin{DoxyParamCaption}
\item[{}]{c, }
\item[{}]{b}
\end{DoxyParamCaption}
)~(($\ast$(pcrc\+\_\+32\+\_\+tab+((({\bf int})(c) $^\wedge$ (b)) \& 0xff))) $^\wedge$ ((c) $>$$>$ 8))}}\label{crypt_8h_a9f548005c00fa0754e9c23b7726bf741}


Definition at line 30 of file crypt.\+h.

\hypertarget{crypt_8h_a2ac0d8ec3c867c44d730a188d8b0418e}{\index{crypt.\+h@{crypt.\+h}!zdecode@{zdecode}}
\index{zdecode@{zdecode}!crypt.\+h@{crypt.\+h}}
\subsubsection[{zdecode}]{\setlength{\rightskip}{0pt plus 5cm}\#define zdecode(
\begin{DoxyParamCaption}
\item[{}]{pkeys, }
\item[{}]{pcrc\+\_\+32\+\_\+tab, }
\item[{}]{c}
\end{DoxyParamCaption}
)~({\bf update\+\_\+keys}(pkeys,pcrc\+\_\+32\+\_\+tab,c $^\wedge$= {\bf decrypt\+\_\+byte}(pkeys,pcrc\+\_\+32\+\_\+tab)))}}\label{crypt_8h_a2ac0d8ec3c867c44d730a188d8b0418e}


Definition at line 76 of file crypt.\+h.

\hypertarget{crypt_8h_ab9d6a91abe3a1127f8b5476ba9ee9316}{\index{crypt.\+h@{crypt.\+h}!zencode@{zencode}}
\index{zencode@{zencode}!crypt.\+h@{crypt.\+h}}
\subsubsection[{zencode}]{\setlength{\rightskip}{0pt plus 5cm}\#define zencode(
\begin{DoxyParamCaption}
\item[{}]{pkeys, }
\item[{}]{pcrc\+\_\+32\+\_\+tab, }
\item[{}]{c, }
\item[{}]{t}
\end{DoxyParamCaption}
)~(t={\bf decrypt\+\_\+byte}(pkeys,pcrc\+\_\+32\+\_\+tab), {\bf update\+\_\+keys}(pkeys,pcrc\+\_\+32\+\_\+tab,c), t$^\wedge$(c))}}\label{crypt_8h_ab9d6a91abe3a1127f8b5476ba9ee9316}


Definition at line 79 of file crypt.\+h.



\subsection{Function Documentation}
\hypertarget{crypt_8h_a8d03722799f8c0c3e0bc1647907e29ab}{\index{crypt.\+h@{crypt.\+h}!decrypt\+\_\+byte@{decrypt\+\_\+byte}}
\index{decrypt\+\_\+byte@{decrypt\+\_\+byte}!crypt.\+h@{crypt.\+h}}
\subsubsection[{decrypt\+\_\+byte}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf int} decrypt\+\_\+byte (
\begin{DoxyParamCaption}
\item[{unsigned {\bf long} $\ast$}]{pkeys, }
\item[{const unsigned {\bf long} $\ast$}]{pcrc\+\_\+32\+\_\+tab}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{crypt_8h_a8d03722799f8c0c3e0bc1647907e29ab}


Definition at line 35 of file crypt.\+h.


\begin{DoxyCode}
36 \{
37     \textcolor{keywordtype}{unsigned} temp;  \textcolor{comment}{/* POTENTIAL BUG:  temp*(temp^1) may overflow in an}
38 \textcolor{comment}{                     * unpredictable manner on 16-bit systems; not a problem}
39 \textcolor{comment}{                     * with any known compiler so far, though */}
40 
41     temp = ((unsigned)(*(pkeys+2)) & 0xffff) | 2;
42     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})(((temp * (temp ^ 1)) >> 8) & 0xff);
43 \}
\end{DoxyCode}
\hypertarget{crypt_8h_a94fdfecb4e9befa8cebfca6a04ed67b3}{\index{crypt.\+h@{crypt.\+h}!init\+\_\+keys@{init\+\_\+keys}}
\index{init\+\_\+keys@{init\+\_\+keys}!crypt.\+h@{crypt.\+h}}
\subsubsection[{init\+\_\+keys}]{\setlength{\rightskip}{0pt plus 5cm}static void init\+\_\+keys (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{passwd, }
\item[{unsigned {\bf long} $\ast$}]{pkeys, }
\item[{const unsigned {\bf long} $\ast$}]{pcrc\+\_\+32\+\_\+tab}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{crypt_8h_a94fdfecb4e9befa8cebfca6a04ed67b3}


Definition at line 65 of file crypt.\+h.


\begin{DoxyCode}
66 \{
67     *(pkeys+0) = 305419896L;
68     *(pkeys+1) = 591751049L;
69     *(pkeys+2) = 878082192L;
70     \textcolor{keywordflow}{while} (*passwd != \textcolor{charliteral}{'\(\backslash\)0'}) \{
71         \hyperlink{crypt_8h_a02bf289cd0d1f899311675e0b3e508d0}{update\_keys}(pkeys,pcrc\_32\_tab,(\textcolor{keywordtype}{int})*passwd);
72         passwd++;
73     \}
74 \}
\end{DoxyCode}
\hypertarget{crypt_8h_a02bf289cd0d1f899311675e0b3e508d0}{\index{crypt.\+h@{crypt.\+h}!update\+\_\+keys@{update\+\_\+keys}}
\index{update\+\_\+keys@{update\+\_\+keys}!crypt.\+h@{crypt.\+h}}
\subsubsection[{update\+\_\+keys}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf int} update\+\_\+keys (
\begin{DoxyParamCaption}
\item[{unsigned {\bf long} $\ast$}]{pkeys, }
\item[{const unsigned {\bf long} $\ast$}]{pcrc\+\_\+32\+\_\+tab, }
\item[{{\bf int}}]{c}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{crypt_8h_a02bf289cd0d1f899311675e0b3e508d0}


Definition at line 48 of file crypt.\+h.


\begin{DoxyCode}
49 \{
50     (*(pkeys+0)) = \hyperlink{crypt_8h_a9f548005c00fa0754e9c23b7726bf741}{CRC32}((*(pkeys+0)), c);
51     (*(pkeys+1)) += (*(pkeys+0)) & 0xff;
52     (*(pkeys+1)) = (*(pkeys+1)) * 134775813L + 1;
53     \{
54       \textcolor{keyword}{register} \textcolor{keywordtype}{int} keyshift = (\hyperlink{ioapi_8h_a787fa3cf048117ba7123753c1e74fcd6}{int})((*(pkeys+1)) >> 24);
55       (*(pkeys+2)) = \hyperlink{crypt_8h_a9f548005c00fa0754e9c23b7726bf741}{CRC32}((*(pkeys+2)), keyshift);
56     \}
57     \textcolor{keywordflow}{return} c;
58 \}
\end{DoxyCode}
